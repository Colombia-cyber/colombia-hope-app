// Chat feature logic and state management